<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Company Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.0"></script>
<style>
body{margin:0;font-family:'Segoe UI',Tahoma,sans-serif;background:#f0f2f5;color:#333;}
nav{position:fixed;top:0;width:100%;background:#1f2937;color:#fff;display:flex;justify-content:space-between;align-items:center;padding:15px 30px;box-shadow:0 2px 6px rgba(0,0,0,.2);z-index:1000;}
nav ul{list-style:none;display:flex;gap:20px;margin:0;} nav ul li{cursor:pointer;} nav ul li:hover{text-decoration:underline;}
section{padding:80px 20px;}
#services{background:linear-gradient(to right,#4f46e5,#6366f1);color:#fff;text-align:center;}
#services h1{font-size:3rem;} #services p{max-width:700px;margin:0 auto 40px;font-size:1.2rem;}
.service-cards{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;}
.service-card{background:rgba(255,255,255,0.1);padding:30px;border-radius:12px;width:250px;transition:transform 0.3s;}
.service-card:hover{transform:translateY(-10px);} .service-card h3{margin-bottom:10px;} .service-card p{font-size:0.95rem;}
#dashboard{background:#fff;text-align:center;} #dashboard h2{margin-bottom:20px;} canvas{max-width:800px;width:90%;margin:0 auto;display:block;}
footer{text-align:center;padding:20px;background:#1f2937;color:#fff;margin-top:50px;}
html{scroll-behavior:smooth;}
@media(max-width:768px){.service-cards{flex-direction:column;align-items:center;}}
</style>
</head>
<body>

<nav>
  <div class="logo"><strong>My Company</strong></div>
  <ul>
    <li><a href="#services">Services</a></li>
    <li><a href="#dashboard">Dashboard</a></li>
  </ul>
</nav>

<section id="services">
<h1>Our Services</h1>
<p>We provide state-of-the-art solutions for monitoring, automation, and industrial data visualization.</p>
<div class="service-cards">
  <div class="service-card">
    <h3>Data Analytics</h3><p>Real-time analysis and insights for industrial sensors and IoT devices.</p>
  </div>
  <div class="service-card">
    <h3>Embedded Systems</h3><p>Design and develop microcontroller-based monitoring and automation solutions.</p>
  </div>
  <div class="service-card">
    <h3>Cloud Monitoring</h3><p>Seamless integration with cloud platforms like ThingSpeak for live data visualization.</p>
  </div>
</div>
</section>

<section id="dashboard">
<h2>Live Sensor Data</h2>
<canvas id="chart" height="300"></canvas>
<p id="status">Initializing...</p>
</section>

<footer>&copy; 2025 My Company. All rights reserved.</footer>

<script>
// CONFIG
const CHANNEL_ID = 2868561;
const FIELD_NUMBER = 1;
const RESULTS = 50;
const READ_API_KEY = "";
const REFRESH_INTERVAL = 15000;
let chart = null;

function buildURL(){
  let url=`https://api.thingspeak.com/channels/${CHANNEL_ID}/feeds.json?results=${RESULTS}`;
  if(READ_API_KEY!=="") url+=`&api_key=${READ_API_KEY}`;
  return url;
}

async function fetchData(){
  const url=buildURL();
  document.getElementById("status").textContent="Loading data...";
  try{
    const res=await fetch(url);
    if(!res.ok) throw new Error(`HTTP ${res.status}`);
    const json=await res.json();

    if(!json.feeds||json.feeds.length===0){ document.getElementById("status").textContent="No data found!"; return; }

    const labels=[];
    const values=[];
    json.feeds.forEach(f=>{
      const v=f[`field${FIELD_NUMBER}`];
      if(v!==null && v!==undefined && v!==""){
        labels.push(new Date(f.created_at));
        values.push(Number(v));
      }
    });

    drawChart(labels,values);
    document.getElementById("status").textContent=`Loaded ${labels.length} points from field ${FIELD_NUMBER}`;
  }catch(err){
    document.getElementById("status").textContent="Error: "+err.message;
    console.error(err);
  }
}

function drawChart(labels,values){
  const ctx=document.getElementById("chart").getContext("2d");
  if(chart){
    chart.data.labels=labels;
    chart.data.datasets[0].data=values;
    chart.update();
  }else{
    chart=new Chart(ctx,{
      type:"line",
      data:{labels:labels,datasets:[{label:`Field ${FIELD_NUMBER}`,data:values,borderColor:"rgba(75,192,192,1)",backgroundColor:"rgba(75,192,192,0.2)",borderWidth:2,pointRadius:3,spanGaps:true}]},
      options:{
        responsive:true,
        scales:{
          x:{type:"time",time:{tooltipFormat:"YYYY-MM-DD HH:mm:ss",unit:"minute"},title:{display:true,text:"Time (UTC)"}},
          y:{title:{display:true,text:`Field ${FIELD_NUMBER} Value`},beginAtZero:false}
        },
        plugins:{legend:{display:true},tooltip:{mode:"index",intersect:false}}
      }
    });
  }
}

// initial load
fetchData();
setInterval(fetchData,REFRESH_INTERVAL);
</script>

</body>
</html>
